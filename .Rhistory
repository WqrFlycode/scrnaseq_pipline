units = "px",
bg = "white",
res = 100)
DimHeatmap(Data, dims = 1:9, cells = 500)
dev.off()
# plot 热图----
png(
filename = paste0(results_dir,"_dimheatmap.",figure_format),
width = 1920,
height = 1080,
units = "px",
bg = "white",
res = 100)
DimHeatmap(Data, dims = 1:9, cells = 500)
dev.off()
which.min(Data@reductions$pca@feature.loadings[,1])
order(Data@reductions$pca@feature.loadings[,1])[1]
order(Data@reductions$pca@feature.loadings[,1])[2]
rownames(Data@reductions$pca@feature.loadings)[1491]
rownames(Data@reductions$pca@feature.loadings)[1260]
order(Data@reductions$pca@feature.loadings[,1])[3]
rownames(Data@reductions$pca@feature.loadings)[235]
order(abs(Data@reductions$pca@feature.loadings[,1]))[3]
order(abs(Data@reductions$pca@feature.loadings[,1]))[1:3]
rownames(Data@reductions$pca@feature.loadings)[c(1288,955,124)]
abs(-1)
order(abs(Data@reductions$pca@feature.loadings[,1]), decreasing = T)[1:3]
rownames(Data@reductions$pca@feature.loadings)[c(80,312,129)]
# plot 热图----
png(
filename = paste0(results_dir,"_dimheatmap.",figure_format),
width = 1920,
height = 1080,
units = "px",
bg = "white",
res = 100)
DimHeatmap(Data, dims = 1:9, cells = 500)
dev.off()
GSE155136_Pig_RawCounts <- read.table("E:/Data/GSE155136_Pig_RawCounts.txt.gz")
head(rownames(GSE155136_Pig_RawCounts))
GSE155136_Pig_RawCounts[1:3,1:3]
GSE155136_Pig_RawCounts <- read.table("E:/Data/GSE155136_Pig_RawCounts.txt.gz",header = T)
GSE155136_Pig_RawCounts[1:3,1:3]
GSE155136_Pig_RawCounts[1:3,1:5]
GSE155136_Pig_TPMs <- read.table("E:/Data/GSE155136_Pig_TPMs.txt.gz",header = T)
GSE155136_Pig_TPMs[1:3,1:6]
rm(GSE155136_Pig_RawCounts,GSE155136_Pig_TPMs)
rm(plot_heatmap,plot_hvg)
rm(top10)
Data <- Clustering(Data = Data, resolution = 1, re = TRUE)
source(paste0(function_dir,"/Clustering.R"))
Data <- Clustering(Data = Data, resolution = 1, re = TRUE)
Data <- Clustering(Data = Data, resolution = 1)
source(paste0(function_dir,"/Annotation.R"))
Data <- Annotation(
Data = Data,
ref_singler_dir = "celldex_ref_dataset/",ref_cell_dex = "MouseRNAseqData",
# ref_markers = markers_list,
re = FALSE
)
source(paste0(function_dir,"/Annotation.R"))
Data <- Annotation(
Data = Data,
ref_singler_dir = "celldex_ref_dataset/",ref_cell_dex = "MouseRNAseqData",
# ref_markers = markers_list,
re = FALSE
)
source(paste0(function_dir,"/Annotation.R"))
Data <- Annotation(
Data = Data,
ref_singler_dir = "celldex_ref_dataset/",ref_cell_dex = "MouseRNAseqData",
# ref_markers = markers_list,
re = FALSE
)
source(paste0(function_dir,"/DifferentialExpressing.R"))
Data <- DifferentialExpressing(Data = Data, re = FALSE)
library(dplyr)
Data <- DifferentialExpressing(Data = Data, re = FALSE)
Data <- DifferentialExpressing(Data = Data, re = FALSE)
head(cluster_max)
unique(cluster_max$cluster)
source(paste0(function_dir,"/DifferentialExpressing.R"))
Data <- DifferentialExpressing(Data = Data, re = FALSE)
dim(Data)
dim(Data@assays$RNA@counts)
Data
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
Data
rm(Data, data_dir, function_dir, paths)
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "GSM3746212_Muscle_1",
data_dir = data_dir,
results_dir = "case/",
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "case",
data_dir = "case/",
results_dir = "case/",
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "case",
data_dir = "case/",
results_dir = "case/",
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "case",
data_dir = "case/",
results_dir = "case/",
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
library(Seurat)
library(ggplot2)
# library(harmony)
library(patchwork)
library(ggpubr)
library(ggrepel)
library(SingleR)
# library(RColorBrewer)
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "case",
data_dir = "case/",
results_dir = "case/",
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "case",
data_dir = "E:/Data/PlatformData/chicken/chicken1. Comparative single-cell transcriptomic analysis reveals/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
Data <- ReadData(
data_name = "case",
data_dir = "E:/Data/PlatformData/chicken/chicken1. Comparative single-cell transcriptomic analysis reveals/",
results_dir = NULL
)
# analysis
analysis_scrnaseq(
data_name = "chicken2",
data_dir = "E:/Data/PlatformData/chicken/chicken2. Direct Reprogramming of Non-limb Fibroblasts/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "chicken2",
data_dir = "E:/Data/PlatformData/chicken/chicken2. Direct Reprogramming of Non-limb Fibroblasts/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "chicken2",
data_dir = "E:/Data/PlatformData/chicken/chicken2. Direct Reprogramming of Non-limb Fibroblasts/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "chicken2",
data_dir = "E:/Data/PlatformData/chicken/chicken2. Direct Reprogramming of Non-limb Fibroblasts/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "chicken3",
data_dir = "E:/Data/PlatformData/chicken/chicken3/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
# analysis
analysis_scrnaseq(
data_name = "chicken3",
data_dir = "E:/Data/PlatformData/chicken/chicken3/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
# analysis
analysis_scrnaseq(
data_name = "chicken3",
data_dir = "E:/Data/PlatformData/chicken/chicken3/",
results_dir = NULL,
pc_num = 50,resolution = 0.5,
ref_singler_dir = "celldex_ref_dataset/",
ref_cell_dex = "MouseRNAseqData"
)
sample_files[1]
sample_files[1] %in% exist_files
exist_files
grep("_matrix.mtx.gz", exist_files)
grep("matrix.mtx.gz", exist_files)
length(grep("_matrix.mtx.gz", exist_files))
length(grep("_matrix.mtx.gz", exist_files)) == 1
length(grep("matrix.mtx.gz", exist_files)) == 1
data_name = "chicken3"
data_dir = "E:/Data/PlatformData/chicken/chicken3/"
results_dir = NULL
files <- list.files(data_dir)
# 文件夹中的所有样本
samples <- sapply(
files[grep("matrix.mtx",files)],
function(x) {
substr(
x = x,
start = 1,
stop = regexpr("matrix.mtx.gz",x)-2
)
},
USE.NAMES = FALSE
)
exist_files <- files[grep(samples[i], files)]
i =1
exist_files <- files[grep(samples[i], files)]
length(grep("features.tsv.gz", exist_files)) == 1 |
length(grep("genes.tsv.gz", exist_files)) == 1
length(grep("features.tsv.gz", exist_files)) == 1
length(grep("genes.tsv.gz", exist_files)) == 1
is_exist <- c(
length(grep("matrix.mtx.gz", exist_files)) == 1,
length(grep("barcodes.tsv.gz", exist_files)) == 1,
length(grep("features.tsv.gz", exist_files)) == 1 |
length(grep("genes.tsv.gz", exist_files)) == 1
)
is_exist
all(is_exist)
all(is_exist)
sample_files[is_exist]
exist_files[is_exist]
sample_files <- exist_files[is_exist]
sample_files <- paste0(data_dir,sample_files)
sample_files
# read expression matrix
data <- Matrix::readMM(file = sample_files[1])
sample_files[1]
grep("matrix.mtx.gz", exist_files)
exist_files
exist_files[grep("matrix.mtx.gz", exist_files)]
list.files("E:/Data/单细胞数据-王章/老鼠的2个样本-GSE110878_RAW/")
list.files("E:/Data/单细胞数据-王章/老鼠的2个样本-GSE110878_RAW/",recursive = T)
read.table("E:/Data/PlatformData/chicken/chicken16/GSE108221_rpkms_sc.txt.gz",header = T,nrows = 5)
GSE108221 <- read.table("E:/Data/PlatformData/chicken/chicken16/GSE108221_rpkms_sc.txt.gz",header = T,nrows = 5)
GSE108221[,1:5]
GSE108221_un <- read.table("E:/Data/PlatformData/chicken/chicken16/GSE108221_rpkms_sc.txt",header = T,nrows = 5)
GSE108221 == GSE108221_un
all(GSE108221 == GSE108221_un)
c(a =3,b=2)
library(Seurat)
library(ggplot2)
# library(harmony)
library(patchwork)
library(ggpubr)
library(ggrepel)
library(SingleR)
# library(RColorBrewer)
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
data_dir <- "E:/Data/PlatformData/chicken/chicken3/"
Data <- ReadData_csv(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
ifelse(a =1 ,1,2)
ifelse(a ==1 ,1,2)
a == 1
a = 1
ifelse(a ==1 ,1,2)
ifelse(a ==2 ,1,2)
files <- list.files(data_dir)
grep("features|genes",files)
files[grep("features|genes",files)]
source(paste0(function_dir,"/ReadData.R"))
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
BYC1 <- read.table("E:/Data/PlatformData/chicken/chicken3/GSM7763719_BYC1.genes.tsv.gz")
head(BYC1)
BYC1[1:10,]
length(grep("ENSGAL",BYC1$V2))/24356
source(paste0(function_dir,"/ReadData.R"))
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
head(colnames(data))
head(barcode.names)
sample_files[3]
sample_files
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
samples
exist_files
grep("features.tsv.gz | features.tsv.gz", exist_files)
grep("features.tsv.gz", exist_files)
grep("genes.tsv.gz", exist_files)
sample_files <- c(
matrix = exist_files[grep("matrix.mtx.gz", exist_files)],
barcodes = exist_files[grep("barcodes.tsv.gz", exist_files)],
genes = exist_files[grep("genes.tsv.gz | features.tsv.gz", exist_files)]
)
sample_files
exist_files[grep("genes.tsv.gz | features.tsv.gz", exist_files)
exist_files[grep("genes.tsv.gz | features.tsv.gz", exist_files)]
exist_files[grep("genes.tsv.gz", exist_files)]
exist_files[grep("genes.tsv.gz|features.tsv.gz", exist_files)]
sample_files <- c(
matrix = exist_files[grep("matrix.mtx.gz", exist_files)],
barcodes = exist_files[grep("barcodes.tsv.gz", exist_files)],
genes = exist_files[grep("genes.tsv.gz|features.tsv.gz", exist_files)]
)
sample_files
# sample_files <- exist_files[is_exist]
sample_files <- paste0(data_dir,sample_files)
sample_files
# read expression matrix
data <- Matrix::readMM(file = sample_files[1])
# read cells
barcode.names = read.delim(
sample_files[2],
header = FALSE,
stringsAsFactors = FALSE
)
colnames(data) = barcode.names$V1
# read genes
gene.names = read.table(
sample_files[3],
header = FALSE,
stringsAsFactors = FALSE
)
if (ncol(gene.names) == 1) {
rownames(data) <-  gene.names$V1
} else {
rownames(data) <-  gene.names$V2
}
source(paste0(function_dir,"/ReadData.R"))
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
Alist <- NULL
names(Alist) <- "a"
Alist <- list()
names(Alist)[1] <- "a"
names(Alist)
Alist[[1]] <- 3
names(Alist)[1] <- "a"
Alist
Alist[[2]] <- 6
names(Alist)[1] <- "b"
Alist
names(Alist)[2] <- "b"
Alist
source(paste0(function_dir,"/ReadData.R"))
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
data
data <- list()
data
source(paste0(function_dir,"/ReadData.R"))
Data <- ReadData_10X(
data_name = "GSE242458",
data_dir = data_dir,
results_dir = NULL
)
data
Data
unique(Data$orig.ident)
prod(dim(Data))
function_dir <- "scripts/"
source(paste0(function_dir,"/ReadData.R"))
source(paste0(function_dir,"/Integration.R"))
source(paste0(function_dir,"/QualityControl.R"))
source(paste0(function_dir,"/DimensionalityReduction.R"))
source(paste0(function_dir,"/Clustering.R"))
source(paste0(function_dir,"/DifferentialExpressing.R"))
source(paste0(function_dir,"/Annotation.R"))
source(paste0(function_dir,"/Enrich.R"))
source(paste0(function_dir,"/TrajectoryAnalysis.R"))
source(paste0(function_dir,"/CellCommunication.R"))
source(paste0(function_dir,"/analysis_scrnaseq.R"))
HH25 <- read.table("E:/Data/PlatformData/chicken/chicken15/GSE130439_RAW/GSM3738693_HH25_counts.txt.gz", header = T)
HH25[1:5,1:5]
